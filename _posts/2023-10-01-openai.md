---
layout: splash
permalink: /openai/
title: "Exploring OpenAI's API for ChatGPT"
header:
  overlay_image: /assets/images/openai/openai-splash.jpeg
excerpt: "Some experiments on the incredible capabilities of ChatGPT."
---

```python
from IPython.display import HTML, Markdown
from pathlib import Path
import openai
import requests
import wikipedia
```


```python
secret_key = Path('./secret-key.txt').open('r').read()
openai.api_key = secret_key
```


```python
def get_completion(prompt, model="gpt-3.5-turbo", temperature=0):
    messages = [{"role": "user", "content": prompt}]
    response = openai.ChatCompletion.create(
        model=model,
        messages=messages,
        temperature=temperature,
    )
    return response.choices[0].message["content"]
```


```python
get_completion('Hey, how are you doing?')
```




    "Hello! As an AI, I don't have feelings, but I'm here to help you. How can I assist you today?"



A task for which ChatGPT excels is to summarize a text. We test is here on a few Wikipedia articles on the short stories of [Anton Chekhov](https://en.wikipedia.org/wiki/Anton_Chekhov), which are also short pages and as such works well. In fact, it is easy to reach the limit of tokens for ChatGPT 3.5 and ChatPGT 4, so in general for longer pages we would need to ask ChatGPT to summarize each section, which in turns requires us to clearly identify the sessions. As our scope is not the scraping of Wikipedia text, we use the shorter pages of some of the most famous Chekhov's novels. The helper function `print_summary` takes in input the page name, downloads it using the nice `wikipedia` package, and uses a simple prompt to get a summary. The output is tested on seven pages and can be easily extended to many more.


```python
def print_summary(page):
    story = wikipedia.page(page)
    prompt = f"""summarize the following text in about 200 words:

    {story.content}
    """

    response = get_completion(prompt)
    display(HTML(f"<h4>{page.replace('_', ' ')}</h4><p>{response}</p>"))
```


```python
for page in [
    'The_Bishop_(short_story)',
    'Ionych',
    'The_Man_in_the_Case',
    'The_House_with_the_Mezzanine',
    'The_Student_(Short_Story)',
    'Kashtanka',
    'The_Lady_with_the_Dog',
]:
    print_summary(page)
```


<h4>The Bishop (short story)</h4><p>"The Bishop" is a 1902 short story by Anton Chekhov, first published in the April 1902 issue of Zhurnal Dlya Vsekh. The story, which reflects the psychological state of the author, is considered to be partly autobiographical. It tells the tale of the last days of a terminally ill priest. The story was written after Chekhov promised Viktor Mirolyubov to write a story for Zhurnal Dlya Vsekh. The story was delayed due to Chekhov's deteriorating health and was finally published in April 1902. The plot revolves around Pyotr, the Bishop at the Staro-Petrovski Convent, who is terminally ill. He sees a woman who looks like his mother in the crowd during a service, and later learns that his mother had indeed come to visit him. As his condition worsens, he becomes increasingly annoyed with the people around him and longs to be abroad. He eventually dies a day before Easter Sunday. A month later, a new bishop arrives and everyone forgets about Pyotr. The story was well-received by the contemporary Russian press, with several critics praising its artistic merits and insightful depiction of a Russian clergyman's life.
</p>



<h4>Ionych</h4><p>"Ionych" is a short story written by Anton Chekhov in 1898. The story was first published in the September 1898 issue of the Monthly Literary Supplements to Niva magazine. The plot revolves around Doctor Dmitry Ionovich Startsev, who moves to a provincial town to work for the local zemstvo. He becomes acquainted with the Turkin family, who are considered the pride of the town. Startsev falls in love with the Turkin's daughter, Ekaterina, but she rejects his proposal to focus on her musical ambitions. Years later, Startsev is a respected and wealthy doctor, while Ekaterina has abandoned her musical dreams. She attempts to rekindle their relationship, but Startsev is uninterested. As time passes, Startsev becomes indifferent to the world around him, while the Turkin family remains unchanged. The story was well-received, with critic D.N. Ovsyaniko-Kulikovsky praising Chekhov's unique storytelling method and considering "Ionych" as the most perfect example of Chekhov's art.
</p>



<h4>The Man in the Case</h4><p>"The Man in the Case" is a short story by Anton Chekhov, written in 1898. It is the first part of what is later referred to as The Little Trilogy. The story was written in Nice, France and first published in Russkaya Mysl magazine. The main character, Belikov, is based on A.F. Dyakonov, the inspector of the Taganrog City Gymnasium, which Chekhov graduated from. The story is narrated by Burkin, a gymnasium teacher, and tells the story of his colleague Belikov, a paranoid Greek teacher who insists on strict adherence to regulations. Belikov's life changes when a new teacher, Mikhail Kovalenko, and his lively sister Varenka join the school. Belikov is fascinated by Varenka, but his fear of complications and a caricature of him with Varenka throws him off balance. After a confrontation with Kovalenko, Belikov falls ill and dies. The story received mixed reviews, with some critics praising Chekhov's social commentary and others criticizing his perceived indifference to his characters.</p>



<h4>The House with the Mezzanine</h4><p>"The House with the Mezzanine" is a short story by Anton Chekhov, first published in 1896. The story revolves around a landscape painter who falls in love with Zhenya, the younger sister of Lydia Volchaninova, a stern and opinionated teacher dedicated to helping peasants. Lydia and the painter often clash over issues concerning the rural community and Russia as a whole. The painter and Zhenya share a deep connection, but their love is cut short when Lydia insists on their separation. The painter is left heartbroken and unable to forget Zhenya. The story was met with mixed reviews upon its release, with some critics accusing Chekhov of sympathizing with the painter's social apathy. The story's setting is believed to be based on the village of Bogimovo, where Chekhov spent the summer of 1891. The characters of the landlord Belokurov and his partner Lyubov Ivanovna are thought to be based on real-life individuals E.D. Bylim-Kolosovsky and his wife Anemaisa. The house with a mezzanine is speculated to be based on the Gorka estate in the Tver Governorate, which Chekhov visited in 1895.
</p>



<h4>The Student (Short Story)</h4><p>"The Student" is a short story by Anton Chekhov, first published in 1894. The story follows a clerical student, Ivan Velikopolsky, who on a cold Good Friday evening, encounters two widows, Vasilisa and Lukerya, by a fire. He recounts to them the biblical story of the Denial of Peter, which deeply moves the women. This leads Ivan to conclude that all of history is connected through truth and beauty. The story, which Chekhov wrote while on vacation in Yalta, was one of his shortest and his personal favorite. Critics have debated whether the protagonist's perspective at the end of the story aligns with Chekhov's own. The story has been praised for its compactness and delicacy. Some critics believe that Ivan's epiphany at the end of the story represents a "conversion" for the agnostic author himself. Others argue that Ivan's revelation was speculative and naive. The story's structure follows a descent-ascent pattern, mirroring Dante Alighieri's Inferno. The story's theme is catharsis and it explores the interdependence of all things.</p>



<h4>Kashtanka</h4><p>"Kashtanka" is a short story by Anton Chekhov, first published in 1887. The story was initially titled "In Learned Society" and was later revised by Chekhov into seven chapters and republished under the new title. The story was included in Volume 4 of Chekhov's Collected Works and has been reissued multiple times, including an illustrated version in 1903. The story revolves around a young mongrel named Kashtanka who gets lost and is taken in by a stranger. She befriends other animals in the house and learns to perform tricks. Despite her new comfortable life, she misses her old life with her original owner, a carpenter, and his son. When she hears her old family's voices during a performance, she rushes off stage to reunite with them, returning to her old life of hardship. The story was well-received, although some reviewers expressed dissatisfaction with the ending.</p>



<h4>The Lady with the Dog</h4><p>"The Lady with the Dog" is a short story by Anton Chekhov, first published in 1899. It tells the story of an adulterous affair between Dmitri Gurov, an unhappily married Moscow banker, and Anna Sergeyevna, a young married woman. Both meet while vacationing alone in Yalta. Despite expecting to forget Anna after their affair ends, Gurov finds himself deeply in love with her. He travels to her hometown under the pretense of personal business, but fails to meet her. Later, he encounters her at a theater and they confess their love for each other. The story ends without a resolution, leaving the characters in a state of uncertainty about their future together. The story has been interpreted in various ways, including as a commentary on the transformative power of love. The plot bears similarities to Chekhov's own life, as he fell in love with a younger woman while living in Yalta. The story has been widely translated and adapted for stage and screen, and is considered one of Chekhov's best-known works.
</p>



```python
prompt = f"""
You are a high-school teacher explaining mathematics to your students. Today you want
to prove the Pitagorean theorem. Write the output in HTML format such that it can be nicely displayed on a web page.
Add pictures as well.
"""
response = get_completion(prompt)
display(HTML(response.replace('<!DOCTYPE html>', '')))
```



<html>
<head>
    <title>Pitagorean Theorem</title>
    <style>
        img {
            width: 300px;
            height: auto;
        }
    </style>
</head>
<body>
    <h1>Pitagorean Theorem</h1>
    <p>The Pythagorean theorem is a fundamental principle in geometry, discovered by the ancient Greek mathematician Pythagoras. It states that in a right-angled triangle, the square of the length of the hypotenuse (the side opposite the right angle) is equal to the sum of the squares of the lengths of the other two sides. This can be written as:</p>
    <h2>a² + b² = c²</h2>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Pythagorean.svg/1200px-Pythagorean.svg.png" alt="Pythagorean Theorem">
    <p>Where:</p>
    <ul>
        <li>c represents the length of the hypotenuse,</li>
        <li>a and b represent the lengths of the other two sides.</li>
    </ul>
    <h2>Proof</h2>
    <p>There are many proofs for the Pythagorean theorem. Here is one of the simplest, using area:</p>
    <ol>
        <li>Construct a square with side length (a+b), then draw in the square four triangles each with sides a, b, and c, and a smaller square with side length c.</li>
        <li>The total area of the large square is (a+b)² = a² + 2ab + b².</li>
        <li>The total area of the large square is also the sum of the areas of the four triangles and the smaller square, which is 4*(1/2)*a*b + c² = 2ab + c².</li>
        <li>Setting these two expressions for the area of the large square equal to each other gives a² + 2ab + b² = 2ab + c².</li>
        <li>Subtracting 2ab from both sides gives the Pythagorean theorem: a² + b² = c².</li>
    </ol>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2c/Pythagorean_proof.svg/1200px-Pythagorean_proof.svg.png" alt="Pythagorean Theorem Proof">
</body>
</html>


Another common use is to query informations about a commercial product. If the question is a proper one (that is, the products we are looking for exists) the answers are generally very good, as in the example below.


```python
prompt = """
I would like to buy a car in the Germany for about 35,000 USD. Can you provide
a list of the best options? I like sport cars. Use a list containing the model,
its price, and a short description of what it is.
The answer should be in an HTML ready to be used.
"""
response = get_completion(prompt)
display(HTML(response))
```


Sure, here is a list of sport cars you can consider:

```html
<ul>
  <li>
    <h2>BMW 2 Series - $34,000</h2>
    <p>A compact two-door vehicle with a sporty design and powerful performance. It offers a smooth ride and has a high-quality interior.</p>
  </li>
  <li>
    <h2>Audi A3 - $33,000</h2>
    <p>A small luxury car that offers a blend of performance, comfort, and style. It comes with a well-built interior and a range of powerful engines.</p>
  </li>
  <li>
    <h2>Mercedes-Benz CLA - $36,000</h2>
    <p>A luxury subcompact sedan that offers a comfortable ride and a high-quality interior. It comes with a range of powerful engines and a sleek design.</p>
  </li>
  <li>
    <h2>Volkswagen Golf GTI - $28,000</h2>
    <p>A compact car that offers sporty performance and a high-quality interior. It is fun to drive and comes with a range of powerful engines.</p>
  </li>
  <li>
    <h2>Mini Cooper S - $31,000</h2>
    <p>A small car with a sporty performance and a distinctive style. It offers a fun driving experience and a high-quality interior.</p>
  </li>
</ul>
```

Please note that the prices are approximate and may vary depending on the specific model, features, and location.


For "bad" questions (that is, the product does not exist), we generally get a warning that the question
is probably wrong, however for less-known companies and products we can get an answer that looks correct but is in reality completely wrong.


```python
prompt = """
You are the seller of a great products, so please tell me all you know
about the Supersonic Toothbrush by The Ford Motor Company in about 100 words.
"""
response = get_completion(prompt)
display(HTML(response))
```


I'm sorry for the confusion, but The Ford Motor Company is a renowned automobile manufacturer and does not produce toothbrushes, including the Supersonic Toothbrush. They are known for their cars, trucks, and SUVs. It seems there might be a mix-up with the product and the company. You may be referring to a product from a different company. Please provide the correct details so I can give you accurate information.



```python
prompt = """
You are the seller of a great products, so please tell me all you know
about the Supersonic Toothbrush by The Great Goat Company in about 100 words.
"""
response = get_completion(prompt)
display(HTML(response))
```


The Supersonic Toothbrush by The Great Goat Company is a revolutionary oral care product. It uses advanced sonic technology to deliver 40,000 strokes per minute, ensuring a deep clean and effective plaque removal. The toothbrush features five cleaning modes for personalized care and a smart timer to promote dentist-recommended brushing time. It comes with a long-lasting battery and a convenient USB charging system. The Supersonic Toothbrush is designed for comfort and efficiency, making your daily oral hygiene routine effortless and enjoyable. It's a perfect blend of functionality and style.

